best_actionstart(T,Cat,F,ClearStart,SChoice) :-
	writeln('calculate best start'),
	distributionalclause:eval_query_backward_distrib( [] , [] ,(S) , (wants_action(H,WA,T)~=B,action_category(WA,T)~=AC,has_focus(WA,T)~=F,has_start(WA,T)~=S,B\==false,AC\==none,F\==none,S\==none ) , 100 , P1),
	changelist(P1,P2),
	keysort(P2,P3),
	reverse(P3,P4),
	changelist3(P4,P5),
	probability_processing(P5, 0.5, Return),
	get_values(Return, Values),

	length(Values,Length),
	( Length > 1 ->
		writeln('No clear enough action start, asking human.'),
		%TODO
		writeln(Values),
		ClearStart = false,
		SChoice = Values
		%ask_commandtype(Values,ChosenComm),
		
	;
		write('Clear enough action start based on probabilities: '),
		nth1(1,Values,ChosenS),
		SChoice = [ChosenS],
		ClearStart = true,
		writeln(ChosenS)
	).


best_actioncategory(H,Clear,L,N) :-
	eval_query_particle2(AC,current(action_category(H))~=AC , N , P1),	
	changelist(P1,P2),
	keysort(P2,P3),
	reverse(P3,P4),
	changelist3(P4,P5),
	probability_processing(P5, 0.5, Return),
	get_values(Return, Values),

	length(Values,Length),
	( Length > 1 ->
		writeln('No clear enough action category, asking human.')
		%TODO
		%ask_commandtype(Values,ChosenComm),
		
	;
		write('Clear enough action category based on probabilities: '),
		nth1(1,Values,ChosenA),
		L = [ChosenA],
		Clear = true,
		writeln(ChosenA)
	).

best_actionfocus(H,Cat,ClearFocus,FChoice,N) :-
	eval_query_particle2(F,(current(has_focus(H))~=F) , N , P1),
	changelist(P1,P2),
	keysort(P2,P3),
	reverse(P3,P4),
	changelist3(P4,P5),
	probability_processing(P5, 0.5, Return),
	get_values(Return, Values),

	length(Values,Length),
	( Length > 1 ->
		writeln('No clear enough action focus, asking human.'),
		%TODO
		writeln(Values),
		ClearFocus = false,
		FChoice = Values,
		get_common_category(Values,CommonC),
		ask_focus(CommonC,Cat,Values),
		step_particle([action(question(focus,choice,FChoice))],[],N),
		robot_current_query(N)
		%ask_commandtype(Values,ChosenComm),
		
	;
		write('Clear enough action focus based on probabilities: '),
		writeln(Values),
		nth1(1,Values,ChosenF),
		FChoice = [ChosenF],
		ClearFocus = true
	).
